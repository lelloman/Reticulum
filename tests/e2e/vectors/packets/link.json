{
  "description": "Link handshake packet test vectors for Reticulum protocol conformance",
  "version": "1.0",
  "format": {
    "linkrequest": "X25519_pub(32) + Ed25519_pub(32) + [mtu_signalling(3)]",
    "lrproof": "signature(64) + X25519_pub(32) + [mtu_signalling(3)]",
    "mtu_signalling": "3 bytes: ((mode << 5) | (mtu >> 16)), (mtu >> 8) & 0xFF, mtu & 0xFF",
    "link_id": "truncated_hash(linkrequest_hashable_part)"
  },
  "vectors": [
    {
      "id": "LINK-001",
      "description": "LINKREQUEST packet without MTU signalling",
      "input": {
        "x25519_pub_hex": "4219d9ce29da42bc823b66b24a051c65b482f062a436bdeb3793bbfa62924930",
        "ed25519_pub_hex": "1cd07b674027511e73469c4edec93634c2965fdeeae8e1c50db4b912c616501b"
      },
      "expected": {
        "payload_hex": "4219d9ce29da42bc823b66b24a051c65b482f062a436bdeb3793bbfa629249301cd07b674027511e73469c4edec93634c2965fdeeae8e1c50db4b912c616501b",
        "payload_length": 64,
        "has_mtu_signalling": false
      }
    },
    {
      "id": "LINK-002",
      "description": "LINKREQUEST packet with MTU signalling (500 bytes, MODE_AES256_CBC)",
      "input": {
        "x25519_pub_hex": "4219d9ce29da42bc823b66b24a051c65b482f062a436bdeb3793bbfa62924930",
        "ed25519_pub_hex": "1cd07b674027511e73469c4edec93634c2965fdeeae8e1c50db4b912c616501b",
        "mtu": 500,
        "mode": 1
      },
      "expected": {
        "mtu_bytes_hex": "2001f4",
        "payload_length": 67,
        "has_mtu_signalling": true
      }
    },
    {
      "id": "LINK-003",
      "description": "LRPROOF packet structure",
      "input": {
        "signature_hex": "d2a6f0be8527261d527045dd810b543a24716b98e0400ed4c793094dffe2e66d55105919691d2c2dd3e79268b9412beec7ea8035fc277796e5eeed25139c2a0e",
        "x25519_pub_hex": "a6ad9609176a4c5012ae056539065be584d5dc92e78ee151dd64654ccf0cd635"
      },
      "expected": {
        "payload_hex": "d2a6f0be8527261d527045dd810b543a24716b98e0400ed4c793094dffe2e66d55105919691d2c2dd3e79268b9412beec7ea8035fc277796e5eeed25139c2a0ea6ad9609176a4c5012ae056539065be584d5dc92e78ee151dd64654ccf0cd635",
        "payload_length": 96,
        "has_mtu_signalling": false
      }
    },
    {
      "id": "LINK-004",
      "description": "MTU signalling byte encoding",
      "input": {
        "mtu": 500,
        "mode": 1
      },
      "expected": {
        "mtu_bytes_hex": "2001f4",
        "mtu_byte_0": 32,
        "mtu_byte_1": 1,
        "mtu_byte_2": 244
      }
    },
    {
      "id": "LINK-005",
      "description": "MTU signalling for large MTU",
      "input": {
        "mtu": 524288,
        "mode": 1
      },
      "expected": {
        "mtu_bytes_hex": "280000",
        "mtu_byte_0": 40,
        "mtu_byte_1": 0,
        "mtu_byte_2": 0
      }
    }
  ]
}
