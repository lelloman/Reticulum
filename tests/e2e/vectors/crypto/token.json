{
  "description": "Token encryption test vectors for Reticulum protocol conformance",
  "version": "1.0",
  "note": "Token format: IV(16) + AES-256-CBC(PKCS7(plaintext)) + HMAC-SHA256(IV+ciphertext). Key is 64 bytes: 32 signing + 32 encryption.",
  "format": {
    "overhead": 48,
    "iv_length": 16,
    "hmac_length": 32,
    "structure": "IV(16) + ciphertext(variable) + HMAC(32)"
  },
  "vectors": [
    {
      "id": "TOKEN-001",
      "description": "Decrypt a known token",
      "input": {
        "key_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",
        "token_hex": "e82058141e2ac6d07cd8391480ab6efabfafc08a202b33f20e86935a57dc500f4e1b35df3f809c81eef1507cdc5b633949be6140539f81a56bf69021188868dd23e64e66c8a14ba58cb2b65536b8aadc"
      },
      "expected": {
        "plaintext_hex": "54657374206461746120666f7220746f6b656e20656e6372797074696f6e",
        "iv_hex": "e82058141e2ac6d07cd8391480ab6efa",
        "ciphertext_hex": "bfafc08a202b33f20e86935a57dc500f4e1b35df3f809c81eef1507cdc5b6339",
        "hmac_hex": "49be6140539f81a56bf69021188868dd23e64e66c8a14ba58cb2b65536b8aadc"
      }
    },
    {
      "id": "TOKEN-002",
      "description": "Verify token structure and HMAC",
      "input": {
        "key_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",
        "iv_hex": "00000000000000000000000000000000",
        "plaintext_hex": "48656c6c6f"
      },
      "note": "This vector is for verifying encryption produces valid HMAC structure. Actual encrypted bytes will differ due to padding alignment."
    },
    {
      "id": "TOKEN-003",
      "description": "Token key layout",
      "input": {
        "full_key_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f"
      },
      "expected": {
        "signing_key_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f",
        "encryption_key_hex": "202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f"
      }
    }
  ]
}
